<div class="container mt-4">

  <h1>Mes réservations</h1>

  <div class="row">

  <% @bookings.each do |booking| %>

    <div class="col-md-4 mt-3 d-flex align-items-stretch">

      <div class="card-details p-4">

        <p>Flat: <%= booking.flat.name %></p>
        <p>Adresse: <%= booking.flat.address %></p>
        <p>Arrivée: <%= booking.start_date %></p>
        <p>Départ: <%= booking.end_date %></p>
        <p>Statut: <%= booking.confirmation %></p>
        <% if booking.confirmation == "pending" && booking.flat.user == current_user %>
          <%= link_to "Accepter", accept_booking_path(booking), data: {"turbo-method": :patch}, class: "btn btn-success" %>
          <%= link_to "Refuser", refuse_booking_path(booking), data: {"turbo-method": :patch}, class: "btn btn-danger" %>
        <% end %>
        <% if booking.flat.user != current_user && !booking.reviews.exists? && booking.confirmation == "accepted" && booking.end_date <= Date.today %>
          <%= simple_form_for ([booking, @review]) do |f| %>
          <%= f.hidden_field :booking_id, value: booking.id %>
          <%= f.input :comment %>
          <%= f.input :rating %>
          <%= f.button :submit%>
          <% end %>
        <% end %>
      </div>

    </div>
  <% end %>


    </div>
</div>
